/* eslint-disable comma-dangle */
/* eslint-disable yoda */
/* eslint-disable one-var */
/* eslint-disable no-sequences */
/* eslint-disable no-unused-expressions */
/* eslint-disable space-before-function-paren */
const pokemonRepository = (function () {
  const e = [];
  function t(t) {
    e.push(t);
  }
  function n(e) {
    const t = e.detailsUrl;
    return fetch(t)
      .then((e) => e.json())
      .then((t) => {
        (e.order = t.order),
          (e.height = t.height),
          (e.types = t.types),
          (e.name = t.name),
          (e.url = t.sprites.front_default);
      })
      .catch((e) => {
        console.error(e);
      });
  }
  function o(e) {
    n(e).then(() => {
      !(function (e) {
        const t = document.querySelector("#modal-name"),
          n = document.querySelector("#modal-height"),
          o = document.querySelector("#modal-image");
        (t.innerText = `Name: ${e.name}`),
          (n.innerText = `Height: ${e.height}`),
          (o.src = `${e.url}`);
      })(e);
    });
  }
  const s = document.querySelector(".modal");
  return (
    document.querySelector(".btn-close").addEventListener("click", () => {
      s.classList.contains("is-visible") && s.classList.remove("is-visible");
    }),
    window.addEventListener("keydown", (e) => {
      "Escape" === e.key &&
        s.classList.contains("is-visible") &&
        s.classList.remove("is-visible");
    }),
    {
      add: t,
      getAll: function () {
        return e;
      },
      addListItem: function (e) {
        const t = document.querySelector(".pokemon-list"),
          n = document.createElement("li");
        n.classList.add("list-group-item");
        const i = document.createElement("button");
        i.classList.add("name-button"),
          i.classList.add("btn"),
          i.classList.add("btn-primary"),
          i.classList.add("btn-lg"),
          (i.type = "button"),
          (i.innerText = e.name),
          n.appendChild(i),
          (function (e, t) {
            e.addEventListener("click", () => {
              o(t), s.classList.add("is-visible");
            });
          })(i, e),
          t.appendChild(n);
      },
      loadList: function () {
        return fetch("https://pokeapi.co/api/v2/pokemon/?limit=150")
          .then((e) => e.json())
          .then((e) => {
            e.results.forEach((e) => {
              t({ name: e.name, detailsUrl: e.url });
            });
          })
          .catch((e) => {
            console.error(e);
          });
      },
      loadDetails: n,
      showDetails: o,
    }
  );
})();
pokemonRepository.loadList().then(() => {
  pokemonRepository.getAll().forEach((e) => {
    pokemonRepository.addListItem(e);
  });
});
